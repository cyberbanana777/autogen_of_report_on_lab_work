from docx import Document
from docx.shared import Pt, Cm, Inches
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.oxml.ns import qn
from docx.oxml import OxmlElement
from docx.enum.table import WD_TABLE_ALIGNMENT
from docx.enum.section import WD_SECTION
import os
import re

# =============================================================================
# –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –°–ö–†–ò–ü–¢–ê - –ù–ê–°–¢–†–û–ô–ö–ò –î–õ–Ø –ö–û–ù–ö–†–ï–¢–ù–û–ô –õ–ê–ë–û–†–ê–¢–û–†–ù–û–ô –†–ê–ë–û–¢–´
# =============================================================================

# –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤
TITLE_PAGE_FILE = "title_page.docx"
OUTPUT_FILE = "–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è_—Ä–∞–±–æ—Ç–∞_1_–æ—Ç—á–µ—Ç.docx"
REQUIREMENTS_FILE = "requirements.pdf"
METHODOLOGY_FILE = "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ1.pdf"

# –ü—É—Ç–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏)
IMAGES = {
    'hardware_config': "Hardware_configuration.jpg",
    'cyclic_layout_1': "—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ_–ø—Ä–æ–≥—Ä–∞–º_–≤_cyclic_–¥–ª—è_1_–≥—Ä–∞—Ñ–∏–∫–∞ (2).jpg",
    'cyclic_layout_2': "—Ä–∞—Å–ø–æ–ª–æ–∂–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º –≤ –æ–¥–Ω–æ–º cyclic –¥–ª—è 2 –≥—Ä–∞—Ñ–∏–∫–∞.jpg",
    'cyclic_layout_3': "—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ_–ø–æ–≥—Ä–∞–º–º_–≤_—Ä–∞–∑–Ω—ã—Ö_cyclic.jpg",
    'graph_1': "–ì—Ä–∞—Ñ–∏–∫1_–ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ –æ–¥–Ω–æ–º 4cyclic.jpg",
    'graph_2': "–ì—Ä–∞—Ñ–∏–∫2_—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ_–ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ –æ–¥–Ω–æ–º 4cyclic –¥—Ä—É–≥–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ.jpg",
    'graph_3': "–ì—Ä–∞—Ñ–∏–∫_–ø—Ä–≥—Ä–∞–º–º—ã_–≤_—Ä–∞–∑–Ω—ã—Ö_cyclic.jpg"
}

# –†—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ä–∞–∑–¥–µ–ª–æ–≤
RUSSIAN_SECTION_NAMES = {
    'Goal': '–¶–µ–ª—å —Ä–∞–±–æ—Ç—ã',
    'Task': '–ó–∞–¥–∞–Ω–∏–µ',
    'Theory': '–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è',
    'Calculations': '–†–∞—Å—á–µ—Ç–Ω–æ-–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å',
    'Conclusions': '–í—ã–≤–æ–¥—ã –ø–æ —Ä–∞–±–æ—Ç–µ',
    'Test': '–û—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã',
    'Bibliography': '–°–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã'
}

# –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ –≤ –æ—Ç—á–µ—Ç–µ
SECTION_ORDER = ['Goal', 'Task', 'Theory', 'Calculations', 'Conclusions', 'Test', 'Bibliography']

# =============================================================================
# –¢–ï–ö–°–¢ –û–¢–ß–ï–¢–ê –î–õ–Ø –õ–ê–ë–û–†–ê–¢–û–†–ù–û–ô –†–ê–ë–û–¢–´ ‚Ññ1
# =============================================================================

REPORT_TEXT = """
[SECTION_START Goal]
–ò–∑—É—á–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ –æ–±—ä–µ–º–∞, —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, –∑–∞–Ω–∏–º–∞–µ–º–æ–≥–æ –º–µ—Å—Ç–∞, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º –Ω–∞ –∏—Ö —Ä–∞–±–æ—Ç—É –≤ Automation Studio.
[SECTION_END Goal]

[SECTION_START Task]
1. –í —Å—Ä–µ–¥–µ Automation Studio —Å–æ–∑–¥–∞—Ç—å 3 –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏—é –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∏–º–µ—é—â–∏–µ —Ä–∞–∑–Ω—ã–π –æ–±—ä–µ–º.
2. –†–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤ –æ–¥–∏–Ω cyclic. –í–∫–ª—é—á–∏—Ç—å –ü—Ä–æ—Ñ–∞–π–ª–µ—Ä –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
3. –†–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ –¥—Ä—É–≥–æ–º –ø–æ—Ä—è–¥–∫–µ, –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ü—Ä–æ—Ñ–∞–π–ª–µ—Ä–µ.
4. –†–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—é –æ–±—ä–µ–º–∞ –≤ —Ä–∞–∑–Ω—ã—Ö, –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö: –≤–æ 2, –≤ 3 –∏ –≤ 4 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –ó–∞–¥–∞—Ç—å –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 2 –æ–±—ä–µ–∫—Ç—É ‚Äì –Ω–µ–±–æ–ª—å—à–æ–π, 3 ‚Äì —Å—Ä–µ–¥–Ω–∏–π, 4 ‚Äì –±–æ–ª—å—à–æ–π.
[SECTION_END Task]

[SECTION_START Theory]
–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–û–°–†–í) ‚Äî —ç—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ–±—ã—Ç–∏—è, –∏–º–µ—é—â–∏–µ –∂—ë—Å—Ç–∫–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è. –û—Å–Ω–æ–≤–Ω–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–æ–π –û–°–†–í —è–≤–ª—è–µ—Ç—Å—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è.

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –û–°–†–í:
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –≤—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏
- –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å ‚Äî —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Å–±–æ—è–º
- –ú–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω–æ—Å—Ç—å ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∑–∞–¥–∞—á –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º

–í Automation Studio –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –û–°–†–í –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ –Ω–∞ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö. –ó–∞–¥–∞—á–∏ –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∞ —Ü–∏–∫–ª–∞, —á—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç Profiler –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á, –∑–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã, —Å—Ç–µ–∫ –∏ —Ç.–¥.
[SECTION_END Theory]

[SECTION_START Calculations]
4.1. –°—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è —Å—Ö–µ–º–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–≥–æ —Å—Ç–µ–Ω–¥–∞ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ 1 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ.

[IMAGE_HARDWARE_CONFIG]

–ü—Ä–æ–≥—Ä–∞–º–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä–µ—Ö –º–æ–¥—É–ª–µ–π, —Ä–µ–∞–ª–∏–∑—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏—é –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞. –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –∏–º–µ–µ—Ç —Ä–∞–∑–Ω—ã–π –æ–±—ä–µ–º –∫–æ–¥–∞ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤–∫–ª—é—á–∞–µ—Ç:
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∑–∞–¥–∞—á–∏ (ProgramInit)
- –¶–∏–∫–ª–∏—á–µ—Å–∫—É—é —á–∞—Å—Ç—å (ProgramCyclic) 
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ (ProgramExit)

4.2. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ 2 –ø–æ–∫–∞–∑–∞–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º –≤ –æ–¥–Ω–æ–º cyclic task –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞.

[IMAGE_CYCLIC_LAYOUT_1]

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ 3 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º –≤ –æ–¥–Ω–æ–º cyclic task, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é Profiler.

[IMAGE_GRAPH_1]

–ê–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø—Ä–∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º –≤ –æ–¥–Ω–æ–º cyclic task –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏.

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ 4 –ø–æ–∫–∞–∑–∞–Ω–æ –¥—Ä—É–≥–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º –≤ cyclic task.

[IMAGE_CYCLIC_LAYOUT_2]

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ 5 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è —ç—Ç–æ–≥–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è.

[IMAGE_GRAPH_2]

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ—Ä—è–¥–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º –æ–±—ä–µ–º–æ–º –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é –∫–æ–¥–∞.

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ 6 –ø–æ–∫–∞–∑–∞–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º –≤ —Ä–∞–∑–Ω—ã—Ö cyclic tasks —Å —Ä–∞–∑–Ω—ã–º–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏.

[IMAGE_CYCLIC_LAYOUT_3]

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ 7 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º –≤ —Ä–∞–∑–Ω—ã—Ö cyclic tasks.

[IMAGE_GRAPH_3]

–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–∞—â–µ –∏ –ø–æ–ª—É—á–∞—é—Ç –±–æ–ª—å—à–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –û–°–†–í.

–¢–∞–±–ª–∏—Ü–∞ 1 ‚Äì –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö

| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è          | –ü—Ä–æ–≥—Ä–∞–º–º–∞ 1 (–º—Å) | –ü—Ä–æ–≥—Ä–∞–º–º–∞ 2 (–º—Å) | –ü—Ä–æ–≥—Ä–∞–º–º–∞ 3 (–º—Å) |
|-----------------------|------------------|------------------|------------------|
| –û–¥–∏–Ω cyclic           | 15.2             | 22.8             | 30.4             |
| –†–∞–∑–Ω—ã–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã     | 10.5             | 18.3             | 45.2             |

[SECTION_END Calculations]

[SECTION_START Conclusions]
–í —Ö–æ–¥–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –±—ã–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω—ã –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ Automation Studio. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –≤–ª–∏—è–Ω–∏–µ –æ–±—ä–µ–º–∞, —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º –Ω–∞ –∏—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.

–û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã:
1. –ü—Ä–æ–≥—Ä–∞–º–º—ã —Å –±–æ–ª—å—à–∏–º –æ–±—ä–µ–º–æ–º –∫–æ–¥–∞ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
2. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–¥–∞—á —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
3. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º –≤ cyclic task –≤–ª–∏—è–µ—Ç –Ω–∞ –æ–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
4. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç Profiler –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á

–¶–µ–ª—å —Ä–∞–±–æ—Ç—ã –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ - –∏–∑—É—á–µ–Ω–æ –≤–ª–∏—è–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ —Ä–∞–±–æ—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º –≤ –û–°–†–í.
[SECTION_END Conclusions]

[SECTION_START Test]
1. –ß—Ç–æ —Ç–∞–∫–æ–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞?
–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ - —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å –ø—Ä–æ–≥—Ä–∞–º–º, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–∏–∫–ª–∞–¥–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º.

2. –ß—Ç–æ —Ç–∞–∫–æ–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –∫–∞–∫–æ–≤—ã –∏—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏?
–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ - —ç—Ç–æ –û–°, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—â–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –≤ –∑–∞–¥–∞–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏: –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

3. –ß—Ç–æ —Ç–∞–∫–æ–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –º—è–≥–∫–æ–≥–æ –∏ –∂–µ—Å—Ç–∫–æ–≥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –∏ –æ–±–ª–∞—Å—Ç–∏ –∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è?
- –ñ–µ—Å—Ç–∫–æ–µ —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è: –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è–º (–ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µÊéßÂà∂Á≥ªÁªü, –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ)
- –ú—è–≥–∫–æ–µ —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã (–º—É–ª—å—Ç–∏–º–µ–¥–∏–π–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–µ—Ç–µ–≤—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)

4. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏?
–î–∏—Å–ø–µ—Ç—á–µ—Ä –∑–∞–¥–∞—á, –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫, –º–µ—Ö–∞–Ω–∏–∑–º—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é, –¥—Ä–∞–π–≤–µ—Ä—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

5. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏ –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.
–í–∫–ª—é—á–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–¥–∞—á —Å —É—á–µ—Ç–æ–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.

6. –¢–∏–ø—ã –∑–∞–¥–∞—á –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö?
–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ, –∞–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ, —Å–ø–æ—Ä–∞–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏.

7. –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∑–∞–¥–∞—á –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö?
–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç, –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –ø–µ—Ä–∏–æ–¥, –¥–µ–¥–ª–∞–π–Ω, –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å.

8. –ú–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏?
Rate Monotonic, Earliest Deadline First, Priority Ceiling Protocol.
[SECTION_END Test]

[SECTION_START Bibliography]
1. –¢–∞–Ω–µ–Ω–±–∞—É–º –≠. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã. - –°–ü–±.: –ü–∏—Ç–µ—Ä, 2015. - 1120 —Å.
2. Automation Studio Documentation. B&R Industrial Automation, 2020.
3. OST 7.32-2017 –û—Ç—á–µ—Ç –æ –Ω–∞—É—á–Ω–æ-–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –ø—Ä–∞–≤–∏–ª–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è.
4. –ì–û–°–¢ –† 7.05-2008 –ë–∏–±–ª–∏–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å—Å—ã–ª–∫–∞. –û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–∞–≤–∏–ª–∞ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è.
[SECTION_END Bibliography]
"""

# =============================================================================
# –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
# =============================================================================

def parse_sections(text):
    """–ü–∞—Ä—Å–∏—Ç —Ç–µ–∫—Å—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏"""
    sections = {}
    lines = text.strip().split('\n')
    current_section = None
    content = []
    
    for line in lines:
        if line.startswith('[SECTION_START'):
            current_section = line.split(' ')[1].replace(']', '')
            content = []
        elif line.startswith('[SECTION_END'):
            sections[current_section] = '\n'.join(content).strip()
            current_section = None
            content = []
        elif current_section is not None:
            content.append(line)
    
    return sections

def set_page_settings(doc):
    """–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º"""
    section = doc.sections[0]
    section.page_height = Cm(29.7)  # A4
    section.page_width = Cm(21)     # A4
    section.top_margin = Cm(2)      # –í–µ—Ä—Ö–Ω–µ–µ –ø–æ–ª–µ 2 —Å–º
    section.bottom_margin = Cm(2)   # –ù–∏–∂–Ω–µ–µ –ø–æ–ª–µ 2 —Å–º
    section.left_margin = Cm(3)     # –õ–µ–≤–æ–µ –ø–æ–ª–µ 3 —Å–º
    section.right_margin = Cm(1.5)  # –ü—Ä–∞–≤–æ–µ –ø–æ–ª–µ 1.5 —Å–º

def add_heading(doc, text, level=1):
    """–î–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Å—Ç–∏–ª–µ–º"""
    heading = doc.add_heading(text, level=level)
    for run in heading.runs:
        run.font.name = 'Times New Roman'
        run.font.size = Pt(14)
        run.bold = True
    # –£–±–∏—Ä–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã –ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
    heading.paragraph_format.space_after = Pt(6)

def add_paragraph(doc, text, bold=False, italic=False):
    """–î–æ–±–∞–≤–ª—è–µ—Ç –∞–±–∑–∞—Ü —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º"""
    if not text.strip():
        return
        
    p = doc.add_paragraph()
    p.alignment = WD_ALIGN_PARAGRAPH.JUSTIFY  # –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —à–∏—Ä–∏–Ω–µ
    run = p.add_run(text)
    run.font.name = 'Times New Roman'
    run.font.size = Pt(12)
    run.bold = bold
    run.italic = italic
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–±–∑–∞—Ü–∞
    p.paragraph_format.line_spacing = 1.5      # –ú–µ–∂—Å—Ç—Ä–æ—á–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª 1.5
    p.paragraph_format.space_before = Pt(0)    # –û—Ç—Å—Ç—É–ø –ø–µ—Ä–µ–¥ –∞–±–∑–∞—Ü–µ–º
    p.paragraph_format.space_after = Pt(0)     # –û—Ç—Å—Ç—É–ø –ø–æ—Å–ª–µ –∞–±–∑–∞—Ü–∞
    p.paragraph_format.first_line_indent = Cm(1.0)  # –ö—Ä–∞—Å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ 1.0 —Å–º

def add_image_with_caption(doc, image_path, caption_text, width=Cm(12)):
    """–î–æ–±–∞–≤–ª—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –ø–æ–¥–ø–∏—Å—å—é –ø–æ —Ü–µ–Ω—Ç—Ä—É"""
    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
        if not os.path.exists(image_path):
            raise FileNotFoundError(f"–§–∞–π–ª {image_path} –Ω–µ –Ω–∞–π–¥–µ–Ω")
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        paragraph = doc.add_paragraph()
        paragraph.alignment = WD_ALIGN_PARAGRAPH.CENTER
        run = paragraph.add_run()
        run.add_picture(image_path, width=width)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–ø–∏—Å—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
        caption_paragraph = doc.add_paragraph()
        caption_paragraph.alignment = WD_ALIGN_PARAGRAPH.CENTER
        caption_run = caption_paragraph.add_run(caption_text)
        caption_run.font.name = 'Times New Roman'
        caption_run.font.size = Pt(12)
        caption_run.italic = True
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –ø–æ—Å–ª–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        doc.add_paragraph()
        
        return True
        
    except FileNotFoundError:
        print(f"‚ö† –§–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω: {image_path}")
        # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–ª—É—à–∫—É, –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
        paragraph = doc.add_paragraph()
        paragraph.alignment = WD_ALIGN_PARAGRAPH.CENTER
        run = paragraph.add_run(f"[–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: {os.path.basename(image_path)} –Ω–µ –Ω–∞–π–¥–µ–Ω–æ]")
        run.font.name = 'Times New Roman'
        run.font.size = Pt(12)
        run.italic = True
        run.font.color.rgb = RGBColor(255, 0, 0)  # –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
        return False
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è {image_path}: {e}")
        return False

def setup_page_numbers(doc):
    """–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –Ω—É–º–µ—Ä–∞—Ü–∏—é —Å—Ç—Ä–∞–Ω–∏—Ü (–Ω–∞—á–∏–Ω–∞—è —Å–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã)"""
    # –î–ª—è –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–∞, –Ω–∞—á–∏–Ω–∞—è —Å–æ –≤—Ç–æ—Ä–æ–π
    for i, section in enumerate(doc.sections):
        if i == 0:  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ç–∏—Ç—É–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            continue
            
        # –û—Ç–∫–ª—é—á–∞–µ–º —Å–≤—è–∑—å —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º footer
        footer = section.footer
        footer.is_linked_to_previous = False
        
        # –û—á–∏—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π footer
        for paragraph in footer.paragraphs:
            p = paragraph._element
            p.getparent().remove(p)
        
        # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π footer —Å –Ω–æ–º–µ—Ä–æ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        footer_paragraph = footer.add_paragraph()
        footer_paragraph.alignment = WD_ALIGN_PARAGRAPH.CENTER
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ –¥–ª—è –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        fld_char = OxmlElement('w:fldChar')
        fld_char.set(qn('w:fldCharType'), 'begin')
        
        instr_text = OxmlElement('w:instrText')
        instr_text.set(qn('xml:space'), 'preserve')
        instr_text.text = "PAGE"
        
        fld_char2 = OxmlElement('w:fldChar')
        fld_char2.set(qn('w:fldCharType'), 'end')
        
        run = footer_paragraph.add_run()
        run._r.append(fld_char)
        run._r.append(instr_text)
        run._r.append(fld_char2)
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        for run in footer_paragraph.runs:
            run.font.name = 'Times New Roman'
            run.font.size = Pt(10)

def process_text_with_images(doc, text, section_name):
    """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç, –∑–∞–º–µ–Ω—è—è –º–µ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏"""
    lines = text.split('\n')
    
    for line in lines:
        if not line.strip():
            continue
            
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–∫–∏ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        if line.strip() == '[IMAGE_HARDWARE_CONFIG]':
            add_image_with_caption(doc, IMAGES['hardware_config'], "–†–∏—Å—É–Ω–æ–∫ 1 - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è")
        elif line.strip() == '[IMAGE_CYCLIC_LAYOUT_1]':
            add_image_with_caption(doc, IMAGES['cyclic_layout_1'], "–†–∏—Å—É–Ω–æ–∫ 2 - –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º –≤ –æ–¥–Ω–æ–º cyclic task")
        elif line.strip() == '[IMAGE_CYCLIC_LAYOUT_2]':
            add_image_with_caption(doc, IMAGES['cyclic_layout_2'], "–†–∏—Å—É–Ω–æ–∫ 3 - –î—Ä—É–≥–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º –≤ cyclic task")
        elif line.strip() == '[IMAGE_CYCLIC_LAYOUT_3]':
            add_image_with_caption(doc, IMAGES['cyclic_layout_3'], "–†–∏—Å—É–Ω–æ–∫ 4 - –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º –≤ —Ä–∞–∑–Ω—ã—Ö cyclic tasks")
        elif line.strip() == '[IMAGE_GRAPH_1]':
            add_image_with_caption(doc, IMAGES['graph_1'], "–†–∏—Å—É–Ω–æ–∫ 5 - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º –≤ –æ–¥–Ω–æ–º cyclic task")
        elif line.strip() == '[IMAGE_GRAPH_2]':
            add_image_with_caption(doc, IMAGES['graph_2'], "–†–∏—Å—É–Ω–æ–∫ 6 - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏ –¥—Ä—É–≥–æ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º")
        elif line.strip() == '[IMAGE_GRAPH_3]':
            add_image_with_caption(doc, IMAGES['graph_3'], "–†–∏—Å—É–Ω–æ–∫ 7 - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º –≤ —Ä–∞–∑–Ω—ã—Ö cyclic tasks")
        else:
            # –û–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç
            add_paragraph(doc, line)

def create_example_table(doc):
    """–°–æ–∑–¥–∞–µ—Ç –ø—Ä–∏–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã —Å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"""
    # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã (–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Å–ª–µ–≤–∞, –Ω–µ –∂–∏—Ä–Ω—ã–π)
    title_para = doc.add_paragraph()
    title_para.alignment = WD_ALIGN_PARAGRAPH.LEFT
    run = title_para.add_run("–¢–∞–±–ª–∏—Ü–∞ 1 ‚Äì –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö")
    run.font.name = 'Times New Roman'
    run.font.size = Pt(12)
    # –ù–µ –∂–∏—Ä–Ω—ã–π, –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç—Å—è
    
    # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
    table = doc.add_table(rows=4, cols=4)
    table.style = 'Table Grid'
    table.alignment = WD_TABLE_ALIGNMENT.CENTER
    
    # –ó–∞–ø–æ–ª–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
    headers = ['–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è', '–ü—Ä–æ–≥—Ä–∞–º–º–∞ 1 (–º—Å)', '–ü—Ä–æ–≥—Ä–∞–º–º–∞ 2 (–º—Å)', '–ü—Ä–æ–≥—Ä–∞–º–º–∞ 3 (–º—Å)']
    for i, header in enumerate(headers):
        cell = table.cell(0, i)
        cell.text = header
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
        for paragraph in cell.paragraphs:
            paragraph.alignment = WD_ALIGN_PARAGRAPH.CENTER
            for run in paragraph.runs:
                run.font.name = 'Times New Roman'
                run.font.size = Pt(10)
                run.bold = True  # –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∂–∏—Ä–Ω—ã–µ
    
    # –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
    data = [
        ['–û–¥–∏–Ω cyclic', '15.2', '22.8', '30.4'],
        ['–†–∞–∑–Ω—ã–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã', '10.5', '18.3', '45.2'],
        ['–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫', '18.7', '15.9', '28.3']
    ]
    
    for row_idx, row_data in enumerate(data, 1):
        for col_idx, value in enumerate(row_data):
            cell = table.cell(row_idx, col_idx)
            cell.text = value
            # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
            for paragraph in cell.paragraphs:
                if col_idx == 0:
                    paragraph.alignment = WD_ALIGN_PARAGRAPH.LEFT
                else:
                    paragraph.alignment = WD_ALIGN_PARAGRAPH.CENTER
                for run in paragraph.runs:
                    run.font.name = 'Times New Roman'
                    run.font.size = Pt(10)
    
    # –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –ø–æ—Å–ª–µ —Ç–∞–±–ª–∏—Ü—ã
    doc.add_paragraph()

# =============================================================================
# –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø
# =============================================================================

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞"""
    print("üöÄ –ù–∞—á–∞–ª–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞ –ø–æ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ ‚Ññ1")
    
    try:
        # 1. –ü–∞—Ä—Å–∏–º —Ç–µ–∫—Å—Ç –æ—Ç—á–µ—Ç–∞ –Ω–∞ —Ä–∞–∑–¥–µ–ª—ã
        sections = parse_sections(REPORT_TEXT)
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω—ã —Å–µ–∫—Ü–∏–∏: {list(sections.keys())}")
        
        # 2. –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç
        try:
            doc = Document(TITLE_PAGE_FILE)
            print("‚úÖ –¢–∏—Ç—É–ª—å–Ω—ã–π –ª–∏—Å—Ç –∑–∞–≥—Ä—É–∂–µ–Ω")
        except FileNotFoundError:
            print("‚ö† –¢–∏—Ç—É–ª—å–Ω—ã–π –ª–∏—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç")
            doc = Document()
        
        # 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        set_page_settings(doc)
        print("‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã")
        
        # 4. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –Ω—É–º–µ—Ä–∞—Ü–∏—é —Å—Ç—Ä–∞–Ω–∏—Ü
        setup_page_numbers(doc)
        print("‚úÖ –ù—É–º–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞")
        
        # 5. –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑—Ä—ã–≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ—Å–ª–µ —Ç–∏—Ç—É–ª—å–Ω–æ–≥–æ –ª–∏—Å—Ç–∞
        doc.add_page_break()
        
        # 6. –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑–¥–µ–ª—ã –æ—Ç—á–µ—Ç–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
        section_number = 1
        for section_name in SECTION_ORDER:
            if section_name in sections:
                russian_name = RUSSIAN_SECTION_NAMES.get(section_name, section_name)
                add_heading(doc, f"{section_number}. {russian_name}", level=1)
                
                # –û—Å–æ–±–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–Ω–æ-–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —á–∞—Å—Ç–∏
                if section_name == 'Calculations':
                    process_text_with_images(doc, sections[section_name], section_name)
                    # –î–æ–±–∞–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É –≤—Ä—É—á–Ω—É—é
                    create_example_table(doc)
                else:
                    process_text_with_images(doc, sections[section_name], section_name)
                
                section_number += 1
                print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª: {russian_name}")
        
        # 7. –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        doc.save(OUTPUT_FILE)
        print(f"‚úÖ –û—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª: {OUTPUT_FILE}")
        
        # 8. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö
        print("\nüìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:")
        for img_name, img_path in IMAGES.items():
            exists = "‚úÖ" if os.path.exists(img_path) else "‚ùå"
            print(f"  {exists} {img_name}: {img_path}")
            
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞: {e}")
        import traceback
        traceback.print_exc()

# =============================================================================
# –ó–ê–ü–£–°–ö –°–ö–†–ò–ü–¢–ê
# =============================================================================

if __name__ == "__main__":
    # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É RGBColor –¥–ª—è —Ü–≤–µ—Ç–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
    try:
        from docx.shared import RGBColor
    except ImportError:
        class RGBColor:
            def __init__(self, r, g, b):
                self.rgb = (r, g, b)
    
    main()
    print("\nüéâ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!")